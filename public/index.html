<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Xarlie's Arcade</title>
    <link rel="stylesheet" href="css/style.css?v=5">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700;900&display=swap" rel="stylesheet">
</head>
<body>

    <audio id="countSound" src="https://www.myinstants.com/media/sounds/ding-sound-effect_2.mp3"></audio>
    <audio id="revealSound" src="https://www.myinstants.com/media/sounds/tada-fanfare-a.mp3"></audio>
    <audio id="dieSound" src="https://www.myinstants.com/media/sounds/sad-trombone.mp3"></audio>
    <audio id="youDiedSound" src="https://www.myinstants.com/media/sounds/roblox-death-sound_1.mp3"></audio>

    <div id="hubScreen">
        <h1 style="color:#ffa502; font-size: 2.8em; margin-bottom: 5px; line-height: 1;">XARLIE'S<br>ARCADE</h1>
        <p style="color:#7f8fa6; margin-bottom: 25px;">Selecciona una sala:</p>
        
        <div class="hub-grid">
            <div class="hub-card" onclick="app.selectRoom('impostor')" style="border-left-color: #fbff00;">
                <div class="hub-icon">ğŸ•µï¸</div>
                <div class="hub-info"><div class="hub-title">El Impostor</div><div class="hub-desc">Palabras ocultas y espÃ­as.</div></div>
                <div style="font-size:1.5em; color:#57606f">âœ</div>
            </div>
            <div class="hub-card" onclick="app.selectRoom('pinturilloImp')" style="border-left-color: #7830ff;">
                <div class="hub-icon">ğŸ¨</div>
                <div class="hub-info"><div class="hub-title">El Falso Artista</div><div class="hub-desc">Dibuja, colabora y descubre al impostor.</div></div>
                <div style="font-size:1.5em; color:#57606f">âœ</div>
            </div>
            <div class="hub-card" onclick="app.selectRoom('lobo')" style="border-left-color: #1cff2f;">
                <div class="hub-icon">ğŸº</div>
                <div class="hub-info"><div class="hub-title">El Lobo</div><div class="hub-desc">Roles, noche y deducciÃ³n.</div></div>
                <div style="font-size:1.5em; color:#57606f">âœ</div>
            </div>
            <div class="hub-card" onclick="app.selectRoom('anecdotas')" style="border-left-color: #ff9ff3;">
                <div class="hub-icon">ğŸ“œ</div>
                <div class="hub-info"><div class="hub-title">AnÃ©cdotas</div><div class="hub-desc">Historias verdaderas (o no).</div></div>
                <div style="font-size:1.5em; color:#57606f">âœ</div>
            </div>
            <div class="hub-card" onclick="app.selectRoom('elmas')" style="border-left-color: #ff3a3a;">
                <div class="hub-icon">ğŸ†</div>
                <div class="hub-info"><div class="hub-title">El MÃS...</div><div class="hub-desc">Vota quiÃ©n encaja mejor.</div></div>
                <div style="font-size:1.5em; color:#57606f">âœ</div>
            </div>
            <div class="hub-card" onclick="app.selectRoom('tabu')" style="border-left-color: #2167ff;">
                <div class="hub-icon">ğŸš«</div>
                <div class="hub-info"><div class="hub-title">TabÃº</div><div class="hub-desc">Equipos y palabras prohibidas.</div></div>
                <div style="font-size:1.5em; color:#57606f">âœ</div>
            </div>
            <div class="hub-card" onclick="app.selectRoom('mus')" style="border-left-color: #2f3542;">
                <div class="hub-icon">ğŸ„</div>
                <div class="hub-info"><div class="hub-title">Registro Mus</div><div class="hub-desc">EstadÃ­sticas y resultados.</div></div>
                <div style="font-size:1.5em; color:#57606f">âœ</div>
            </div>
            <div class="hub-card" onclick="app.selectRoom('feedback')" style="border-left-color: #416348; margin-top: 15px;">
                <div class="hub-icon">ğŸ’Œ</div>
                <div class="hub-info"><div class="hub-title">Feedback</div><div class="hub-desc">Sugerencias y errores.</div></div>
                <div style="font-size:1.5em; color:#57606f">âœ</div>
            </div>
        </div>
        <div style="margin-top: 30px; text-align: center; color: #555;"><h3>Â¿QuÃ© pasa pisha?</h3><div style="font-size: 2em;">ğŸ¤ </div></div>
    </div>

    <div id="loginScreen" class="hidden">
        <div class="back-nav"><button onclick="app.goBackToHub()">â¬… Volver</button></div>
        <h1 style="color:#ffa502">Juego</h1>
        <div class="card">
            <p style="margin-bottom:10px;">Nombre:</p>
            <input type="text" id="username" placeholder="Tu nombre..." maxlength="12" autocomplete="off">
            <button class="main-btn" onclick="app.joinGame()">ENTRAR</button>
        </div>
        <div id="loginRulesArea" class="rules-box hidden" style="margin-top:20px; border-left: 5px solid #ffa502; background: #2f3542; padding: 15px; text-align: left;">
            <h3 style="margin-top:0; color: #fff;">ğŸ“– CÃ³mo se juega:</h3>
            <div id="loginRulesText" style="line-height: 1.4em; color: #ccc;">...</div>
        </div>
    </div>

    <div id="impostorLobby" class="hidden">
        <div class="back-nav" style="display:flex; gap:5px;">
            <button onclick="app.goBackToHub(false)" style="flex:1; background:#57606f;">ğŸ  Sala</button>
            <button onclick="app.goBackToHub(true)" style="flex:1; background:#eb4d4b;">âŒ Salir</button>
        </div>        
        <h2 style="color:#ffa502">ğŸ•µï¸ Impostor Lobby</h2>
        
        <div id="impostorAdminPanel" class="admin-panel hidden">
            <div style="background:#222; padding:10px; border-radius:10px; margin-bottom:15px; border:1px solid #444;">
                
                <div class="control-row" style="background:transparent; padding:2px; margin:0; justify-content:space-between;">
                    <span>Impostores:</span>
                    <div style="display:flex; align-items:center; gap:5px;">
                        <button onclick="app.impostor.changeImpostors(-1)" style="width:30px; height:30px; padding:0;">-</button>
                        <span id="impostorCountDisp" style="font-weight:bold; width:20px; text-align:center">1</span>
                        <button onclick="app.impostor.changeImpostors(1)" style="width:30px; height:30px; padding:0;">+</button>
                    </div>
                </div>

                <div class="control-row" style="background:transparent; padding:2px; margin:5px 0; justify-content:space-between;">
                    <span>CategorÃ­a:</span>
                    <select id="impostorCategory" style="width:120px; border-radius:5px; padding:2px;">
                        </select>
                </div>
                
                <div class="control-row" style="background:transparent; padding:2px; margin:0; justify-content:space-between;">
                    <span>Pistas:</span>
                    <input type="checkbox" id="impostorHints" style="width:20px; height:20px;">
                </div>
            </div>

            <button class="start-btn" onclick="app.impostor.startGame()">â–¶ï¸ EMPEZAR PARTIDA</button>
        </div>

        <p id="waitMsg" style="color:#aaa; font-style:italic;">Esperando al administrador...</p>
        
        <h3>Jugadores (<span id="playerCount">0</span>)</h3>
        <ul id="playerList"></ul>
    </div>

    <div id="impostorGame" class="hidden">
        <div class="back-nav" style="display:flex; gap:5px;">
            <button onclick="app.goBackToHub(false)" style="flex:1; background:#57606f;">ğŸ  Sala</button>
            <button onclick="app.goBackToHub(true)" style="flex:1; background:#eb4d4b;">âŒ Salir</button>
        </div>    
        <div style="display:flex; justify-content:space-between; width:100%; margin-bottom:10px;">
            <h2 style="margin:0">En Curso</h2>
        </div>

        <div id="roleCard" class="blur-content" onclick="app.impostor.toggleRole()">
            <h1 id="myRoleTitle">...</h1>
            <p id="myRoleWord" style="font-size: 2em; font-weight: 900; color: #ffeaa7; margin: 10px 0;">...</p>
            <p id="myRoleInfo" style="font-size: 0.9em; color: #ccc;">...</p>
        </div>
        <div class="card-note">ğŸ‘† Clicar o mantener para ver rol</div>

        <div style="font-size: 0.8em; color:#888; margin-bottom: 20px;">
            Iniciador: <span id="starterName" style="color:white">...</span> | Cat: <span id="catsPlayed" style="color:white">...</span>
        </div>

        <div id="voteSection" class="hidden" style="width:100%">
            <h3 style="color:#ff4757">ğŸ—³ï¸ Â¡VOTAR AL IMPOSTOR!</h3>
            
            <div style="display:flex; justify-content:flex-end; margin-bottom:10px; gap: 5px;">
                 <button id="btnShowResults" class="kick-btn hidden" style="width:auto; font-size:0.8em; padding:5px 10px; background:#ffa502;" onclick="app.impostor.revealResults()">ğŸ‘ï¸ Resultados</button>
                 
                 <button id="btnEndVoting" class="kick-btn hidden" style="width:auto; font-size:0.8em; padding:5px 10px;" onclick="app.impostor.resetGame()">â¹ï¸ Finalizar</button>
                 <button id="btnClearVotes" class="kick-btn hidden" style="width:auto; font-size:0.8em; padding:5px 10px; background:#555;" onclick="app.impostor.clearVotes()">Limpiar Votos</button>
            </div>
            
            <div id="voteGrid" class="vote-grid"></div>
        </div>
        
        <div id="countdownOverlay" class="hidden" style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:200; display:flex; justify-content:center; align-items:center;">
            <div id="countdownNumber" style="font-size:10em; color:#ff4757; font-weight:900;">3</div>
        </div>
        
        <div id="summaryModal" class="hidden modal-overlay">
            <h1 style="color:#e17055; font-size:3em;">RESUMEN</h1>
            <h2 id="sumWord" style="color:#ffeaa7; font-size:2.5em; margin:10px 0;"></h2>
            <p id="sumHint" style="color:#ccc"></p>
            <div style="background:#ff4757; color:white; padding:10px; width:100%; border-radius:10px; margin:20px 0;">
                <h3>ğŸ”ª Eran Impostores:</h3>
                <div id="sumImpostors" style="font-size:1.5em; font-weight:bold;"></div>
            </div>
            <button onclick="document.getElementById('summaryModal').classList.add('hidden')" class="main-btn">Continuar</button>
        </div>
    </div>

    <div id="loboLobby" class="hidden">
        <div class="back-nav" style="display:flex; gap:5px;">
            <button onclick="app.goBackToHub(false)" style="flex:1; background:#57606f;">ğŸ  Sala</button>
            <button onclick="app.goBackToHub(true)" style="flex:1; background:#eb4d4b;">âŒ Salir</button>
        </div>
        <h2 style="color:#74b9ff">ğŸº Sala El Lobo</h2>
        
        <div id="loboAdminPanel" class="admin-panel hidden">
            <div class="control-row">
                <button onclick="app.lobo.adj('wolvesCount',-1)">-</button>
                <span>Lobos: <span id="val_wolvesCount">2</span></span>
                <button onclick="app.lobo.adj('wolvesCount',1)">+</button>
            </div>
            <div class="category-grid">
                <button class="cat-btn" id="btn_hasSeer" onclick="app.lobo.tog('hasSeer')">ğŸ”® Vidente<br><span id="val_hasSeer">SI</span></button>
                <button class="cat-btn" id="btn_hasGirl" onclick="app.lobo.tog('hasGirl')">ğŸ‘§ NiÃ±a<br><span id="val_hasGirl">NO</span></button>
                <button class="cat-btn" id="btn_hasCupid" onclick="app.lobo.tog('hasCupid')">ğŸ’˜ Cupido<br><span id="val_hasCupid">NO</span></button>
                <button class="cat-btn" id="btn_hasHunter" onclick="app.lobo.tog('hasHunter')">ğŸ”« Cazador<br><span id="val_hasHunter">NO</span></button>
            </div>
            <button class="start-btn" onclick="app.lobo.start()">ğŸŒ™ EMPEZAR</button>
        </div>
        
        <p id="loboWaitMsg" style="color:#aaa">Esperando al admin...</p>
        <h3>Aldeanos (<span id="loboPlayerCount">0</span>)</h3>
        <ul id="loboPlayerList" style="margin-top:20px"></ul>
    </div>

    <div id="loboGame" class="hidden">
        <div class="back-nav" style="display:flex; gap:5px;">
            <button onclick="app.goBackToHub(false)" style="flex:1; background:#57606f;">ğŸ  Sala</button>
            <button onclick="app.goBackToHub(true)" style="flex:1; background:#eb4d4b;">âŒ Salir</button>
        </div>
        
        <div id="loboCard" class="blur-content" onclick="app.lobo.toggleRole()">
            <h1>Tu Rol</h1>
            <div id="loboRoleTitle" style="font-size:2.5em; font-weight:bold; color:white;">...</div>
            <p id="loboRoleDesc" style="color:#ccc;">...</p>
            <div id="loboWolfPartners" class="hidden" style="background:#2d3436; padding:10px; border-radius:5px; margin-top:10px;">
                <strong style="color:#ff7675">CompaÃ±eros:</strong><br>
                <span id="loboPartnersText"></span>
            </div>
        </div>
        <div class="card-note">ğŸ‘† Clicar o mantener para ver rol</div>

        <div style="margin-top:20px; width:100%">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                <h3 style="color:#74b9ff; margin:0">ğŸ—³ï¸ VotaciÃ³n</h3>
                <button id="loboClearVotesBtn" class="kick-btn hidden" style="width:auto; padding:5px 10px; font-size:0.8em; background:#555" onclick="app.lobo.clearVotes()">Limpiar</button>
            </div>
            <div id="loboVoteGrid" class="vote-grid"></div>
        </div>

        <button onclick="app.lobo.reset()" class="kick-btn hidden" id="loboResetBtn" style="margin-top:20px; width:100%;">Resetear Partida</button>
    </div>

    <div id="anecdotasLobby" class="hidden">
        <div class="back-nav" style="display:flex; gap:5px;">
            <button onclick="app.goBackToHub(false)" style="flex:1; background:#57606f;">ğŸ  Sala</button>
            <button onclick="app.goBackToHub(true)" style="flex:1; background:#eb4d4b;">âŒ Salir</button>
        </div>
        <h2 style="color:#ff9ff3">ğŸ“œ AnÃ©cdotas</h2>
        <div class="card" style="background:#dfe6e9; border:none;">
            <h3 style="color:#2d3436">Tu historia:</h3>
            <textarea id="anecdotaInput" class="anecdota-input" placeholder="Cuenta algo breve..."></textarea>
            <button id="saveAnecdotaBtn" class="main-btn" onclick="app.anecdotas.save()" style="background:#6c5ce7;">ğŸ’¾ Listo</button>
        </div>
        <ul id="anecdotasList"></ul>
        <button id="anecdotasStartBtn" class="start-btn hidden" onclick="app.anecdotas.start()">â–¶ï¸ EMPEZAR</button>
    </div>

    <div id="anecdotasGame" class="hidden">
        <div class="back-nav" style="display:flex; gap:5px;">
            <button onclick="app.goBackToHub(false)" style="flex:1; background:#57606f;">ğŸ  Sala</button>
            <button onclick="app.goBackToHub(true)" style="flex:1; background:#eb4d4b;">âŒ Salir</button>
        </div>

        <div id="anecdotasRevealModal" class="hidden modal-overlay">
            <h2 style="color:#ccc">El autor era...</h2>
            <h1 style="color:#2ed573; font-size:3.5em; margin:20px 0;" id="revealAuthor">...</h1>
            <div id="revealVoters" style="color:#fff; font-weight:bold;"></div>
            <p style="color:#aaa; margin-top:30px;">Siguiente en 5s...</p>
        </div>
        
        <div id="anecdotasPodiumModal" class="hidden modal-overlay">
            <h1 style="color:#f1c40f; margin-bottom:30px;">ğŸ† GANADORES</h1>
            <div class="podium-container">
                <div class="podium-bar p-silver"><span class="p-name" id="anecPodium2">...</span>ğŸ¥ˆ</div>
                <div class="podium-bar p-gold"><span class="p-name" id="anecPodium1">...</span>ğŸ¥‡</div>
                <div class="podium-bar p-bronze"><span class="p-name" id="anecPodium3">...</span>ğŸ¥‰</div>
            </div>
            <button onclick="app.anecdotas.reset()" class="main-btn" style="margin-top:30px">Volver al Lobby</button>
        </div>

        <h3 id="roundCounter" style="color:#aaa">Ronda 1</h3>
        <div class="anecdota-card">
            <p id="currentAnecdotaText">...</p>
        </div>
        <p style="text-align:center; margin-bottom:10px;">Â¿De quiÃ©n es?</p>
        <div id="votingGrid" class="vote-grid"></div>
        <button id="nextRoundBtn" class="main-btn hidden" onclick="app.anecdotas.next()">Siguiente â¡</button>
        <button onclick="app.anecdotas.reset()" class="kick-btn hidden" style="margin-top:20px">Reset Total</button>
    </div>

    <div id="elmasLobby" class="hidden">
        <div class="back-nav" style="display:flex; gap:5px;">
            <button onclick="app.goBackToHub(false)" style="flex:1; background:#57606f;">ğŸ  Sala</button>
            <button onclick="app.goBackToHub(true)" style="flex:1; background:#eb4d4b;">âŒ Salir</button>
        </div>
        <h2 style="color:#ff9f43">ğŸ† El MÃS...</h2>
        <div id="elmasAdminPanel" class="admin-panel hidden">
            <div class="control-row">
                <span>Rondas:</span>
                <input type="number" id="elmasRoundsInput" value="5" min="3" max="20" style="width:60px; border:none; border-radius:5px; padding:5px; text-align:center; color:#000;">
            </div>
            <button class="start-btn" onclick="app.elmas.start()">â–¶ï¸ EMPEZAR</button>
        </div>
        <ul id="elmasList" style="margin-top:20px;"></ul>
    </div>

    <div id="elmasGame" class="hidden">
        <div class="back-nav" style="display:flex; gap:5px;">
            <button onclick="app.goBackToHub(false)" style="flex:1; background:#57606f;">ğŸ  Sala</button>
            <button onclick="app.goBackToHub(true)" style="flex:1; background:#eb4d4b;">âŒ Salir</button>
        </div>

        <h4 id="elmasRoundCount" style="color:#aaa">Ronda 1/5</h4>
        
        <div class="card" style="background:#ff9f43; color:#2d3436; border:none; margin-bottom: 20px;">
            <p id="elmasQuestionText" style="font-size:1.5em; font-weight:900; margin: 10px 0;">...</p>
        </div>
        
        <div id="elmasVotingGrid" class="vote-grid"></div>
        
        <br>
        
        <button id="elmasNextBtn" class="main-btn hidden" onclick="app.elmas.next()">ğŸ“Š Ver Votos</button>
        <button id="elmasContinueBtn" class="main-btn hidden" onclick="app.elmas.continue()">â¡ï¸ Siguiente Pregunta</button>
        
        <button onclick="app.elmas.reset()" class="kick-btn hidden" style="margin-top:30px">Reset Total (Admin)</button>
    </div>

    <div id="elmasPodiumModal" class="hidden modal-overlay">
        <h1 style="color:#ff9f43; margin-bottom:30px">ğŸ† RESULTADOS ğŸ†</h1>
        
        <div class="podium-container">
            <div class="podium-bar p-silver"><span class="p-name" id="podium2">...</span>ğŸ¥ˆ</div>
            <div class="podium-bar p-gold"><span class="p-name" id="podium1">...</span>ğŸ¥‡</div>
            <div class="podium-bar p-bronze"><span class="p-name" id="podium3">...</span>ğŸ¥‰</div>
        </div>
        <p style="color:#aaa; margin-top:30px">Cerrando en 10 segundos...</p>
    </div>

    <div id="tabuLobby" class="hidden">
        <div class="back-nav" style="display:flex; gap:5px;">
            <button onclick="app.goBackToHub(false)" style="flex:1; background:#57606f;">ğŸ  Sala</button>
            <button onclick="app.goBackToHub(true)" style="flex:1; background:#eb4d4b;">âŒ Salir</button>
        </div>
        <h2 style="color:#00b894">ğŸš« Sala TabÃº</h2>
        
        <div style="display:flex; gap:10px; margin-bottom:20px; width:100%">
            <div style="flex:1">
                <button id="btnTeamBLUE" class="team-btn team-blue" onclick="app.tabu.joinTeam('BLUE')" style="width:100%">AZUL ğŸ”µ</button>
                <ul id="listBlue" style="margin-top:5px; min-height:50px; background:rgba(9, 132, 227, 0.2)"></ul>
            </div>
            <div style="flex:1">
                <button id="btnTeamRED" class="team-btn team-red" onclick="app.tabu.joinTeam('RED')" style="width:100%">ROJO ğŸ”´</button>
                <ul id="listRed" style="margin-top:5px; min-height:50px; background:rgba(214, 48, 49, 0.2)"></ul>
            </div>
        </div>
        
        <h4 style="color:#aaa">Espectadores:</h4>
        <ul id="listSpectators"></ul>

        <div id="tabuAdminPanel" class="admin-panel hidden" style="margin-top:20px">
            <div style="background:#222; padding:15px; border-radius:10px; margin-bottom:15px; border: 1px solid #444;">
                
                <div class="control-row" style="background:transparent; box-shadow:none; margin:0; padding:5px; justify-content:space-between;">
                    <span>Rondas:</span>
                    <input type="number" id="tabuRounds" value="3" min="1" 
                           style="width:80px; padding:5px; text-align:center; color:#2d3436; background:#fff; border-radius:5px; border:none; font-weight:bold;">
                </div>
                
                <div class="control-row" style="background:transparent; box-shadow:none; margin:0; padding:5px; justify-content:space-between;">
                    <span>Tiempo (s):</span>
                    <input type="number" id="tabuDuration" value="60" step="10" min="10" 
                           style="width:80px; padding:5px; text-align:center; color:#2d3436; background:#fff; border-radius:5px; border:none; font-weight:bold;">
                </div>
                
                <div class="control-row" style="background:transparent; box-shadow:none; margin:0; padding:5px; justify-content:space-between;">
                    <span>Saltos:</span>
                    <input type="number" id="tabuSkips" value="3" min="0" 
                           style="width:80px; padding:5px; text-align:center; color:#2d3436; background:#fff; border-radius:5px; border:none; font-weight:bold;">
                </div>
            </div>
            
            <button class="start-btn" onclick="app.tabu.start()">â–¶ï¸ EMPEZAR</button>
        </div>
        
        <p id="tabuWaitMsg" style="color:#aaa">Esperando al admin...</p>
    </div>

    <div id="tabuGame" class="hidden">
        <div class="back-nav" style="display:flex; gap:5px;">
            <button onclick="app.goBackToHub(false)" style="flex:1; background:#57606f;">ğŸ  Sala</button>
            <button onclick="app.goBackToHub(true)" style="flex:1; background:#eb4d4b;">âŒ Salir</button>
        </div>

        <div style="display:flex; justify-content:space-between; background:#2f3542; padding:10px; border-radius:10px; border:2px solid #57606f; margin-bottom:20px;">
            <div style="color:#0984e3; font-weight:bold; font-size:1.5em">ğŸ”µ <span id="scoreBlue">0</span></div>
            <div style="text-align:center">
                <div id="timerDisp" style="font-size:2em; font-weight:bold; font-family:monospace">60</div>
                <div id="roundDisp" style="font-size:0.8em; color:#aaa">Ronda 1</div>
            </div>
            <div style="color:#d63031; font-weight:bold; font-size:1.5em"><span id="scoreRed">0</span> ğŸ”´</div>
        </div>

        <div id="tabuCardArea" style="width:100%"></div>

        <div id="tabuActionButtons" class="hidden" style="position:fixed; bottom:20px; left:0; width:100%; padding:20px; display:flex; gap:10px;">
            <button onclick="app.tabu.taboo()" style="background:#ff4757; flex:1; height:70px; font-size:1.2em; box-shadow:0 4px 0 #c0392b">ğŸš« MAL</button>
            
            <button id="btnSkip" onclick="app.tabu.skip()" style="background:#ffa502; flex:1; height:70px; font-size:1.2em; box-shadow:0 4px 0 #e67e22; color:#000;">â­ï¸ SALTAR</button>
            
            <button onclick="app.tabu.correct()" style="background:#2ed573; flex:1; height:70px; font-size:1.2em; box-shadow:0 4px 0 #218c74">âœ… BIEN</button>
        </div>
        
        <div id="tabuGameOverModal" class="hidden modal-overlay">
            <h1 id="winnerText" style="color:#a55eea; font-size:3em">...</h1>
            <h2 id="finalScoreText" style="color:#fff">0 - 0</h2>
            <h3 style="margin-top:20px; color:#aaa">EstadÃ­sticas (Aciertos)</h3>
            <ul id="mvpList" style="max-height:300px; overflow-y:auto; text-align:left;"></ul>
            
            <button id="tabuAdminResetBtn" onclick="app.tabu.reset()" class="main-btn hidden" style="margin-top:20px">Volver al Lobby (Admin)</button>
            <p id="tabuWaitingMsg" class="waiting-text hidden">Esperando al admin...</p>
        </div>
    </div>
    
    <div id="feedbackScreen" class="hidden">
        <div class="back-nav"><button onclick="app.goBackToHub()">â¬… Volver</button></div>
        <h2 style="color:#a29bfe">ğŸ’Œ Feedback</h2>
        <div class="card">
            <select id="fbType" onchange="app.feedback.renderForm()" style="width:100%; padding:10px; margin-bottom:10px; border-radius:5px;">
                <option value="newword">âœ¨ Idea / Palabra</option>
                <option value="bug">ğŸ› Reportar Error</option>
                <option value="general">ğŸ’¬ Comentario</option>
            </select>
            <div id="fbWordForm">
                <input id="fbWord" type="text" placeholder="Palabra sugerida..." style="margin-bottom:5px;">
                <input id="fbHint" type="text" placeholder="Pista (opcional)...">
            </div>
            <div id="fbStandardForm" class="hidden">
                <textarea id="fbContent" rows="3" style="width:100%; border-radius:5px; padding:5px;" placeholder="Escribe aquÃ­..."></textarea>
            </div>
            <button onclick="app.feedback.submit()" class="main-btn" style="background:#a29bfe; box-shadow:0 4px 0 #6c5ce7">Enviar</button>
        </div>
        <button onclick="app.feedback.toggleReadMode()" class="secondary">ğŸ“– Leer Feedback</button>
        <div id="feedbackReadSection" class="hidden">
            <ul id="feedbackList" style="margin-top:10px; max-height:300px; overflow-y:auto; background:#222; padding:10px; border-radius:5px;"></ul>
        </div>
    </div>

    <div id="pinturilloImpLobby" class="hidden">
        <div class="back-nav" style="display:flex; gap:5px;">
            <button onclick="app.goBackToHub(false)" style="flex:1; background:#57606f;">ğŸ  Sala</button>
            <button onclick="app.goBackToHub(true)" style="flex:1; background:#eb4d4b;">âŒ Salir</button>
        </div>
        <h2 style="color:#7830ff">ğŸ¨ El Falso Artista</h2>
        
        <div id="pintuImpAdminControls" class="admin-panel hidden">
            <div style="background:#222; padding:10px; border-radius:10px; margin-bottom:15px; border:1px solid #444;">
                <div class="control-row" style="background:transparent; padding:2px; margin:0; justify-content:space-between;">
                    <span>Impostores:</span>
                    <div style="display:flex; align-items:center; gap:5px;">
                        <button onclick="app.pinturilloImp.changeImpostors(-1)" style="width:30px; height:30px; padding:0;">-</button>
                        <span id="pintuImpImpostorCount" style="font-weight:bold; width:20px; text-align:center">1</span>
                        <button onclick="app.pinturilloImp.changeImpostors(1)" style="width:30px; height:30px; padding:0;">+</button>
                    </div>
                </div>
                
                <div class="control-row" style="background:transparent; padding:2px; margin:5px 0; justify-content:space-between;">
                    <span>Vueltas:</span>
                    <input type="number" id="pintuRounds" value="1" min="1" max="5" style="width:50px; text-align:center; border-radius:5px;">
                </div>

                <div class="control-row" style="background:transparent; padding:2px; margin:5px 0; justify-content:space-between;">
                    <span>CategorÃ­a:</span>
                    <select id="pintuCategory" style="width:100px; border-radius:5px;">
                        <option value="MIX">Mezcla</option>
                        <option value="OBJETO">Objetos</option>
                        <option value="LUGAR">Lugares</option>
                        <option value="ACCION">Acciones</option>
                    </select>
                </div>

                <div class="control-row" style="background:transparent; padding:2px; margin:0; justify-content:space-between;">
                    <span>Pistas:</span>
                    <input type="checkbox" id="pintuHints" style="width:20px; height:20px;">
                </div>
            </div>

            <button class="start-btn" onclick="app.pinturilloImp.start()">â–¶ï¸ EMPEZAR</button>
        </div>

        <p id="pintuImpWaitMsg" style="color:#aaa">Esperando al admin...</p>
        <h3>Jugadores (<span id="pintuImpCount">0</span>)</h3>
        <ul id="pintuImpList"></ul>
    </div>

    <div id="pinturilloImpGame" class="hidden">
        <div class="back-nav" style="display:flex; gap:5px; margin-bottom:10px;">
            <button onclick="app.goBackToHub(false)" style="flex:1; background:#57606f;">ğŸ  Sala</button>
            <button onclick="app.goBackToHub(true)" style="flex:1; background:#eb4d4b;">âŒ Salir</button>
        </div>
        
        <div id="pintuRoundIndicator" style="color:#aaa; font-size:0.9em; text-align:center; margin-bottom:5px;"></div>

        <div class="card-note">ğŸ‘† Toca la tarjeta para ver tu rol</div>

        <div id="pintuImpRoleCard" class="blur-content" onclick="app.pinturilloImp.toggleRole()" style="margin-bottom: 20px; background: #2f3542; padding: 20px; border-radius: 10px; border: 2px solid #57606f;">
            <h1 id="pintuImpRoleTitle" style="margin:0;">...</h1>
            <p id="pintuImpRoleWord" style="font-size:1.5em; color:#e1b12c; margin:5px 0;">...</p>
            <p id="pintuImpHint" style="font-size:0.9em; color:#74b9ff; margin:0; display:none;">...</p>
        </div>

        <div id="pintuImpDrawArea" class="hidden" style="width:100%">
            <div id="drawStatus" class="draw-status">...</div>
            
            <div class="canvas-container">
                <canvas id="pintuImpCanvas" width="300" height="300"></canvas>
            </div>

            <div class="canvas-controls hidden" id="myDrawControls">
                <button onclick="app.pinturilloImp.undo()" style="width:48%; background:#eb4d4b">Deshacer</button>
                <button id="btnPassTurn" onclick="app.pinturilloImp.passTurn()" style="width:48%; background:#6ab04c" disabled>Pasar</button>
            </div>
        </div>

        <div id="pintuImpVoteSection" class="hidden" style="width:100%; margin-top:20px;">
            <h3 style="color:#ff4757">ğŸ—³ï¸ Â¡VOTACIÃ“N!</h3>
            <div style="display:flex; justify-content:flex-end; margin-bottom:10px; gap:5px;">
                 <button id="pintuImpShowRes" class="kick-btn hidden" style="background:#ffa502;" onclick="app.pinturilloImp.revealResults()">ğŸ‘ï¸</button>
                 <button id="pintuImpEndVote" class="kick-btn hidden" onclick="app.pinturilloImp.reset()">â¹ï¸</button>
                 <button id="pintuImpClearVote" class="kick-btn hidden" style="background:#555;" onclick="app.pinturilloImp.clearVotes()">Limpiar</button>
            </div>
            <div id="pintuImpVoteGrid" class="vote-grid"></div>
        </div>
        
        <div id="pintuImpSummaryModal" class="hidden modal-overlay">
            <h1 style="color:#e17055; font-size:3em;">RESUMEN</h1>
            <h2 id="pintuImpSumWord" style="color:#ffeaa7; font-size:2.5em; margin:10px 0;"></h2>
            <div style="background:#ff4757; color:white; padding:10px; width:100%; border-radius:10px; margin:20px 0;">
                <h3>ğŸ”ª Impostores:</h3>
                <div id="pintuImpSumImpostors" style="font-size:1.5em; font-weight:bold;"></div>
            </div>
            <button onclick="document.getElementById('pintuImpSummaryModal').classList.add('hidden')" class="main-btn">Cerrar</button>
        </div>
    </div>
    
    <div id="floatingUserWidget" class="hidden" 
         style="position:fixed; top:10px; right:10px; z-index:99999; background:rgba(44, 62, 80, 0.9); padding:8px 15px; border-radius:25px; border:1px solid #ffffff55; color:#fff; cursor:grab; box-shadow: 0 4px 10px rgba(0,0,0,0.5); text-align:right; font-size:0.85em; user-select:none; backdrop-filter:blur(5px); min-width:120px; touch-action: none;">
        <div id="floatingUserText">Cargando...</div>
    </div>

    <div id="musScreen" class="hidden">
        <div class="back-nav"><button onclick="app.goBackToHub()">â¬… Volver</button></div>
        <h2 style="color:#e1b12c; margin-bottom:5px;">ğŸ„ Registro de Mus</h2>
        
        <div style="display:flex; gap:5px; margin-bottom:15px; overflow-x:auto;">
            <button class="kick-btn" style="width:auto; font-size:0.8em; background:#44bd32" onclick="app.mus.addPlayer()">+ Jugador</button>
            <button class="kick-btn" style="width:auto; font-size:0.8em; background:#0984e3" onclick="app.mus.showAddMatchModal()">+ Partida</button>
            <button class="kick-btn" style="width:auto; font-size:0.8em; background:#57606f" onclick="app.mus.refresh()">ğŸ”„</button>
            <button class="kick-btn" style="width:auto; font-size:0.8em; background:#d63031" onclick="app.mus.backup()">ğŸ’¾ Backup</button>
        </div>

        <div class="card" style="padding:10px; margin-bottom:15px; background:#222;">
            <label style="color:#aaa; font-size:0.8em;">Modo de VisualizaciÃ³n:</label>
            <select id="musViewMode" onchange="app.mus.changeView()" style="width:100%; padding:8px; border-radius:5px; margin-top:5px;">
                <option value="ranking_pair">ğŸ† Ranking Parejas (Rondas)</option>
                <option value="ranking_player">ğŸ‘¤ Ranking Individual (Rondas)</option> <option value="vic_pareja">Total Rondas de 1 Pareja</option>
                <option value="vic_persona">Total Rondas de 1 Persona</option>
                <option value="porc_pareja">Promedio Rondas de 1 Pareja</option>
                <option value="porc_persona">Promedio Rondas de 1 Persona</option>
                <option value="examinar_persona">ğŸ”¬ Examinar Persona (Avanzado)</option>
                <option value="examinar_pareja">ğŸ”¬ Examinar Pareja (Avanzado)</option>
            </select>

            <div id="musFilterControls" class="hidden" style="margin-top:10px;">
                <div id="divFilterPair" class="hidden">
                    <label>Pareja:</label>
                    <select id="musFilterPair" onchange="app.mus.changeView()" style="width:100%"></select>
                </div>
                <div id="divFilterPlayer" class="hidden">
                    <label>Jugador:</label>
                    <select id="musFilterPlayer" onchange="app.mus.changeView()" style="width:100%"></select>
                </div>
            </div>

            <div id="musAnalysisContainer" class="hidden" style="margin-top:10px; border-top:1px solid #444; padding-top:10px;">
                <div id="divExamPlayer">
                    <label>Persona:</label>
                    <select id="musExamPlayer" onchange="app.mus.runAnalysis()" style="width:100%; margin-bottom:5px;"></select>
                    <label>Analizar:</label>
                    <select id="musExamTypeP" onchange="app.mus.runAnalysis()" style="width:100%">
                        <option value="with_partner">Promedio junto a...</option>
                        <option value="vs_win">Promedio victorias frente a...</option>
                        <option value="vs_loss">Promedio derrotas frente a...</option>
                    </select>
                </div>
                <div id="divExamPair" class="hidden">
                    <label>Pareja:</label>
                    <select id="musExamPair" onchange="app.mus.runAnalysis()" style="width:100%; margin-bottom:5px;"></select>
                    <label>Analizar:</label>
                    <select id="musExamTypePair" onchange="app.mus.runAnalysis()" style="width:100%">
                        <option value="vs_pair_win">Promedio victorias frente a pareja...</option>
                        <option value="vs_pair_loss">Promedio derrotas frente a pareja...</option>
                    </select>
                </div>
            </div>
        </div>

        <div id="musStatsContainer" style="text-align:center;"></div>

        <div id="musAddMatchModal" class="hidden modal-overlay" style="align-items:flex-start; padding-top:50px; overflow-y:auto;">
            <div style="background:#2f3542; padding:20px; border-radius:10px; width:90%; max-width:400px; border:2px solid #57606f;">
                <h3 style="margin-top:0;">Nueva Partida</h3>
                
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                    <div style="flex:1; text-align:center; background:rgba(9, 132, 227, 0.2); padding:5px; border-radius:5px;">
                        <h4 style="margin:0; color:#74b9ff">Pareja 1</h4>
                        <select id="musP1" style="width:90%; margin:5px 0;"></select>
                        <select id="musP2" style="width:90%; margin:5px 0;"></select>
                        <input type="number" id="musS1" placeholder="Rondas" style="width:50px; text-align:center;">
                    </div>
                    <div style="font-weight:bold; padding:0 5px;">VS</div>
                    <div style="flex:1; text-align:center; background:rgba(214, 48, 49, 0.2); padding:5px; border-radius:5px;">
                        <h4 style="margin:0; color:#ff7675">Pareja 2</h4>
                        <select id="musP3" style="width:90%; margin:5px 0;"></select>
                        <select id="musP4" style="width:90%; margin:5px 0;"></select>
                        <input type="number" id="musS2" placeholder="Rondas" style="width:50px; text-align:center;">
                    </div>
                </div>

                <div style="display:flex; gap:10px; margin-top:20px;">
                    <button onclick="document.getElementById('musAddMatchModal').classList.add('hidden')" style="background:#555; flex:1;">Cancelar</button>
                    <button onclick="app.mus.submitMatch()" class="main-btn" style="flex:1;">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <div style="display:flex; gap:5px; margin-bottom:15px; overflow-x:auto;">
            </div>

        <div class="card" style="padding:10px; margin-bottom:15px; background:#222; display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
            <label style="color:#e1b12c;">ğŸ“… Desde:</label>
            <input type="date" id="musDateStart" onchange="app.mus.changeView()" style="flex:1; min-width:120px;">
            <label style="color:#e1b12c;">Hasta:</label>
            <input type="date" id="musDateEnd" onchange="app.mus.changeView()" style="flex:1; min-width:120px;">
        </div>

        <div id="musAnalysisContainer" class="hidden" style="margin-top:10px; border-top:1px solid #444; padding-top:10px;">
                <div style="margin-top:15px; border-top:1px dashed #555; padding-top:10px;">
                    <label>ğŸ“ˆ GrÃ¡fico:</label>
                    <select id="musChartInterval" onchange="app.mus.runAnalysis()" style="width:100%; margin-bottom:10px;">
                        <option value="day">Por DÃ­as</option>
                        <option value="month">Por Meses</option>
                        <option value="year">Por AÃ±os</option>
                    </select>
                    <div style="background:rgba(255,255,255,0.05); padding:10px; border-radius:8px;">
                        <canvas id="musChartCanvas" height="200"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div id="musStatsContainer" style="text-align:center;"></div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


    <script src="/socket.io/socket.io.js"></script>
    <script src="js/main.js?v=2"></script>
    <script src="js/impostor.js"></script>
    <script src="js/lobo.js"></script>
    <script src="js/anecdotas.js"></script>
    <script src="js/elmas.js"></script>
    <script src="js/tabu.js"></script>
    <script src="js/pinturilloImp.js"></script>
    <script src="js/feedback.js"></script>
    <script src="js/mus.js"></script>
</body>
</html>